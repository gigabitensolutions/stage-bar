<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Comandas ‚Äî POS Simples</title>
  <meta name="description" content="POS de comandas com PIX fixo, pagamento cart√£o, PDF, vis√£o geral, impress√£o t√©rmica 80mm, e modo toque grande.">
  <link rel="stylesheet" href="./assets/app.css"/>
  <link rel="stylesheet" href="./assets/print.css" media="print"/>

  <!-- Libs: jsPDF e QRCode (CDN) -->
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

  <!-- App JS -->
  <script defer src="./assets/pos.js"></script>
</head>
<body>
  <header>
    <div class="wrap">
      <div class="row">
        <h1>üßæ Comandas</h1>
        <div class="right row">
          <button class="btn" id="bigTouchBtn" title="Aumentar √°reas de toque">Toque grande</button>
          <select id="comandaSelect" class="select"></select>
          <button class="btn" id="overviewBtn" title="Vis√£o geral">Vis√£o geral</button>
          <button class="btn" id="newComandaBtn" title="Nova comanda">Nova</button>
          <button class="btn danger" id="deleteComandaBtn" title="Excluir comanda atual">Excluir</button>
          <a class="btn ghost" href="./admin.html">Admin</a>
        </div>
      </div>
      <div class="toolbar">
        <input id="search" class="input" placeholder="Buscar produto‚Ä¶"/>
        <button id="clearSearch" class="btn ghost">Limpar</button>
        <button id="importProductsBtn" class="btn">Importar JSON</button>
        <input id="importFile" type="file" accept="application/json" class="hidden" />
      </div>
      <div id="chips" class="chips"></div>
    </div>
  </header>

  <main>
    <section id="grid" class="grid"></section>
  </main>

  <!-- Bottom bar -->
  <div class="bar">
    <div class="bar-inner">
      <span id="summaryCount" class="muted">0 itens</span>
      <strong id="summaryTotal" class="price">R$ 0,00</strong>
      <button id="openDrawer" class="btn accent">Abrir comanda</button>
    </div>
  </div>

  <!-- Drawer -->
  <div id="drawer" class="drawer" role="dialog" aria-modal="true" aria-labelledby="drawerTitle">
    <div class="sheet">
      <div class="flex">
        <div>
          <h2 id="drawerTitle">Comanda</h2>
          <div class="mini" id="comandaNameMini">‚Äî</div>
          <div class="mini">Etiqueta: <span id="comandaLabelMini">‚Äî</span></div>
        </div>
        <div class="row">
          <button class="btn ghost" id="colorBtn">Cor</button>
          <button class="btn ghost" id="closeDrawer">Fechar</button>
        </div>
      </div>

      <div id="lines"></div>

      <div class="hr"></div>
      <label class="switch">
        <input type="checkbox" id="sv10">
        <span>Adicionar 10% (servi√ßo)</span>
      </label>

      <div class="hr"></div>
      <div>
        <div class="mini">Forma de pagamento</div>
        <div id="payMethods" class="chips"></div>
      </div>

      <div class="totals">
        <div class="line"><span>Subtotal</span><strong id="subtotalTxt">R$ 0,00</strong></div>
        <div class="line"><span>Servi√ßo (10%)</span><strong id="serviceTxt">R$ 0,00</strong></div>
        <div class="line"><span>Total</span><strong id="totalTxt">R$ 0,00</strong></div>
      </div>

      <div class="actions">
        <button class="btn" id="pixBtn" title="Gerar QR PIX do total">PIX do total</button>
        <button class="btn" id="print80Btn" title="Imprimir cupom t√©rmico 80mm">Imprimir 80mm</button>
        <button class="btn warn" id="pdfBtn">Gerar PDF</button>
        <button class="btn" id="shareBtn">Compartilhar</button>
        <button class="btn" id="clearItemsBtn">Limpar itens</button>
        <button class="btn danger" id="closeComandaBtn">Fechar comanda</button>
      </div>

      <!-- PIX Modal -->
      <div id="pixModal" class="modal" aria-hidden="true">
        <div class="panel">
          <h3>PIX do total</h3>
          <div class="mini">Use o QR abaixo para pagar o total desta comanda.</div>
          <div id="pixQR" class="centered"></div>
          <div class="form-row">
            <textarea id="pixPayload" class="input" rows="3" readonly></textarea>
          </div>
          <div class="row">
            <button class="btn" id="copyPixBtn">Copiar c√≥digo PIX</button>
            <button class="btn ghost right" id="closePixBtn">Fechar</button>
          </div>
        </div>
      </div>

    </div>
  </div>

  <!-- Nova Comanda Modal -->
  <div id="newModal" class="modal" aria-hidden="true">
    <div class="panel">
      <h3>Nova comanda</h3>
      <div class="form-row">
        <label>Nome</label>
        <input id="newName" class="input" placeholder="Mesa 7, Cliente Ana‚Ä¶">
      </div>
      <div class="form-row">
        <label>Etiqueta (opcional)</label>
        <input id="newLabel" class="input" placeholder="Varanda, Delivery, VIP‚Ä¶">
      </div>
      <div class="form-row">
        <label>Cor</label>
        <div class="swatches" id="newColorSwatches"></div>
      </div>
      <div class="row">
        <button class="btn accent" id="createComandaConfirm">Criar</button>
        <button class="btn ghost right" id="cancelNew">Cancelar</button>
      </div>
    </div>
  </div>

  <!-- Vis√£o Geral -->
  <div id="overviewModal" class="modal" aria-hidden="true">
    <div class="panel">
      <h3>Vis√£o geral das comandas</h3>
      <div id="board" class="board"></div>
      <div class="row" style="margin-top:8px">
        <button class="btn ghost right" id="closeOverviewBtn">Fechar</button>
      </div>
    </div>
  </div>

  <!-- Auxiliares invis√≠veis -->
  <div id="qrHidden" style="position:absolute;left:-9999px;top:-9999px"></div>
</body>
</html>
