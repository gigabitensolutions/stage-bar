<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
  <meta name="theme-color" content="#0f172a"/>
  <title>Comandas ‚Äî GitHub Pages</title>
  <link rel="stylesheet" href="./assets/app.css"/>
  <link rel="stylesheet" href="./assets/print.css" media="print"/>
  <!-- libs -->
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
</head>
<body>
  <header>
    <div class="wrap">
      <div class="row">
        <h1>üßæ Comandas</h1>
        <div class="right row">
          <button id="bigTouchBtn" class="btn ghost" aria-pressed="false">Toque grande</button>
          <button id="overviewBtn" class="btn">Vis√£o geral</button>
          <select id="comandaSelect" class="select" style="min-width:160px"></select>
          <button id="deleteComandaBtn" class="btn danger">Excluir</button>
          <button id="importProductsBtn" class="btn">Importar produtos</button>
          <input id="importFile" class="hidden" type="file" accept="application/json">
        </div>
      </div>

      <!-- Nova comanda inline -->
      <div class="newc">
        <input id="ncName" class="input" placeholder="Nome da comanda (ex.: Mesa 1)" value="Mesa 1">
        <input id="ncLabel" class="input" placeholder="Etiqueta (opcional)">
        <div id="ncColors" class="swatches"></div>
        <button id="ncAdd" class="btn accent">Nova comanda</button>
      </div>

      <div class="toolbar">
        <input id="search" class="input" placeholder="Buscar produto por nome/categoria..."/>
        <button id="clearSearch" class="btn ghost">Limpar</button>
        <button id="openDrawer" class="btn warn">Abrir comanda</button>
      </div>
      <div id="chips" class="chips"></div>
    </div>
  </header>

  <main>
    <section id="grid" class="grid"></section>
  </main>

  <div class="bar">
    <div class="bar-inner">
      <span id="summaryCount" class="muted">0 itens</span>
      <strong id="summaryTotal" class="price">R$ 0,00</strong>
      <button id="openDrawer" class="btn accent">Abrir comanda</button>
    </div>
  </div>

  <!-- Drawer / Sheet -->
  <div id="drawer" class="drawer" aria-hidden="true">
    <div class="sheet" role="dialog" aria-modal="true">
      <div class="row" style="justify-content:space-between;align-items:center">
        <h2>Comanda: <span id="comandaNameMini">‚Äî</span> <span id="comandaLabelMini"></span></h2>
        <div class="row">
          <button id="colorBtn" class="btn ghost" title="Cor/etiqueta">Cor</button>
          <button id="closeDrawer" class="btn">Fechar</button>
        </div>
      </div>

      <div id="lines"></div>

      <div class="row totals">
        <div class="switch">
          <label><input id="sv10" type="checkbox"> Cobrar servi√ßo (10%)</label>
        </div>
        <div class="right"></div>
        <div><span class="muted">Subtotal:</span> <strong id="subtotalTxt">R$ 0,00</strong></div>
        <div><span class="muted">Servi√ßo:</span> <strong id="serviceTxt">R$ 0,00</strong></div>
        <div><span class="muted">Total:</span> <strong id="totalTxt">R$ 0,00</strong></div>
      </div>

      <div style="margin-top:8px">
        <div class="muted" style="margin-bottom:6px">Forma de pagamento</div>
        <div id="payMethods" class="chips"></div>
      </div>

      <div class="actions">
        <button id="pixBtn" class="btn accent">PIX</button>
        <button id="shareBtn" class="btn">Compartilhar</button>
        <button id="pdfBtn" class="btn">PDF</button>
        <button id="print80Btn" class="btn">Imprimir 80mm</button>
        <button id="clearItemsBtn" class="btn warn">Limpar itens</button>
        <button id="closeComandaBtn" class="btn danger">Fechar</button>
      </div>
    </div>
  </div>

  <!-- Modal: PIX -->
  <div id="pixModal" class="modal" aria-hidden="true">
    <div class="panel" role="dialog" aria-modal="true">
      <h3>Pagamento via PIX</h3>
      <div id="pixQR" style="display:flex;justify-content:center;margin:10px 0"></div>
      <input id="pixPayload" class="input" readonly>
      <div class="row" style="margin-top:10px">
        <button id="copyPixBtn" class="btn">Copiar c√≥digo</button>
        <button id="closePixBtn" class="btn">Fechar</button>
      </div>
    </div>
  </div>

  <!-- Modal: Vis√£o geral -->
  <div id="overviewModal" class="modal" aria-hidden="true">
    <div class="panel" role="dialog" aria-modal="true">
      <h3>Comandas Abertas</h3>
      <div id="board" class="form-row"></div>
      <div class="row" style="margin-top:12px">
        <button id="closeOverviewBtn" class="btn">Fechar</button>
      </div>
    </div>
  </div>

  <!-- Hidden target for QR toDataURL -->
  <div id="qrHidden" class="hidden"></div>

  <script src="./assets/firebase-config.js"></script>
  <script src="./assets/db.firebase.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
  <script src="./assets/pos.js"></script>
</body>
</html>
